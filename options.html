<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BOSS直聘助手 - 设置</title>
  <link rel="stylesheet" href="options.css">
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>设置</h1>
      <p class="subtitle">配置AI服务以获得更智能的匹配分析</p>

      <div>
        <!-- AI服务商选择 -->
        <div class="form-section">
          <label class="form-label">
            AI服务提供商
          </label>
          <select id="aiProvider" class="form-control">
            <option value="none">不使用AI（使用本地算法）</option>
            <option value="kimi">Kimi (Moonshot AI) - 推荐用于文件解析</option>
            <option value="openai">OpenAI GPT</option>
            <option value="claude">Anthropic Claude</option>
            <option value="zhipu">智谱AI (GLM)</option>
            <option value="qwen">通义千问</option>
          </select>
        </div>

        <!-- API Key -->
        <div id="apiKeySection" class="form-section hidden">
          <label class="form-label">
            API Key
            <span class="form-hint">
              你的API密钥将安全存储在本地
            </span>
          </label>
          <input 
            type="password" 
            id="apiKey" 
            placeholder="请输入你的API Key"
            class="form-control"
          >
          <button 
            type="button" 
            id="toggleApiKey"
            class="toggle-btn"
          >
            显示/隐藏
          </button>
        </div>

        <!-- Base URL (可选) -->
        <div id="baseUrlSection" class="form-section hidden">
          <label class="form-label">
            BaseURL (可选)
            <span class="form-hint">
              自定义API端点，如使用代理
            </span>
          </label>
          <input 
            type="text" 
            id="baseUrl" 
            placeholder="例如: https://api.openai.com/v1"
            class="form-control"
          >
        </div>

        <!-- 模型选择 -->
        <div id="modelSection" class="form-section hidden">
          <label class="form-label">
            模型
            <span class="form-hint">
              可从列表选择或自定义输入
            </span>
          </label>
          <input 
            type="text" 
            id="aiModel" 
            list="modelList"
            placeholder="留空使用默认模型，或输入自定义模型名称"
            class="form-control"
          >
          <datalist id="modelList">
            <!-- 模型选项将由JS动态填充 -->
          </datalist>
        </div>

        <!-- 提示信息 -->
        <div id="providerInfo" class="info-box hidden">
          <h3>获取API Key</h3>
          <p id="providerInfoText"></p>
        </div>
      </div>

      <!-- 简历管理 -->
      <div class="divider">
        <h2 class="section-title">简历管理</h2>
        <p class="subtitle">上传一次，多次使用</p>

        <div class="form-section">
          <label class="form-label">
            我的简历
            <span class="form-hint">
              支持 PDF, DOC, DOCX, TXT 格式
            </span>
          </label>
          
          <div id="resumeUploadArea" class="upload-area-settings">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="48" height="48">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
            </svg>
            <p class="upload-text">点击或拖拽上传简历</p>
            <p class="upload-hint">支持 PDF, DOC, DOCX, TXT 格式，最大 5MB</p>
          </div>
          <input type="file" id="resumeFileInput" class="hidden" accept=".pdf,.doc,.docx,.txt">
          
          <div id="currentResume" class="current-resume hidden">
            <div class="resume-info">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <div class="resume-details">
                <p class="resume-name" id="resumeName">未上传简历</p>
                <p class="resume-meta" id="resumeMeta"></p>
              </div>
              <button id="deleteResumeBtn" class="delete-btn" title="删除简历">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- 保存按钮 -->
        <div class="button-group">
          <button 
            id="saveBtn"
            class="btn btn-primary"
          >
            保存设置
          </button>
          <button 
            id="testBtn"
            class="btn btn-secondary"
          >
            测试连接
          </button>
        </div>

        <!-- 状态消息 -->
        <div id="statusMessage" class="status-message hidden"></div>
      </div>

      <!-- 使用说明 -->
      <div class="divider">
        <h2 class="section-title">使用说明</h2>
        <div class="prose">
          <ul>
            <li>选择你偏好的AI服务提供商</li>
            <li>输入对应的API Key（需要自行申请）</li>
            <li>模型名称可从下拉列表选择，也可以自定义输入（支持新模型或自定义模型）</li>
            <li>Base URL可自定义，用于使用代理或自建服务</li>
            <li>点击"测试连接"验证配置是否正确</li>
            <li>保存设置后即可在插件中使用AI功能</li>
            <li>如不配置AI服务，插件将使用本地算法进行匹配分析</li>
          </ul>
        </div>
      </div>

      <!-- 隐私说明 -->
      <div class="privacy-box">
        <h3>隐私声明</h3>
        <p>
          你的API Key和所有配置信息仅存储在本地浏览器中，不会上传到任何服务器。
          简历内容仅在分析时通过API发送给你选择的AI服务提供商。
        </p>
      </div>
    </div>
  </div>

  <script src="file-parser.js"></script>
  <script src="options.js"></script>
</body>
</html>
